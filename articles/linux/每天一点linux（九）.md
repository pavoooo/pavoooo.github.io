# 每天一点linux（九）

`函数`一系列语句的集合。`shell`中也存在函数的概念，`shell`中的函数可以看作是`命令`的集合。`shell`中函数定义的格式如下：

```bash
[ function ] 函数名称 [()]
{
  函数体
  [return 语句]
}
```

函数的定义有两点需要说明：

- 定义函数的时候可以带`function`关键字，也可以不带`function`关键字。总体来说

```bash
function func() {

}
```

等价于

```bash
func() {

}
```

![](/blog/linux-imgs/func1.png)

- 函数可以有返回值，通过`return`语句直接返回。也可以没有return语句，这个时候会以函数最后一条命令运行的结果作为返回值。

> 如果显示指定了return语句，那么合格语句需要返回一个(0-255)的整数

```bash
#!/bin/bash
function test() {
  ls -al .
  return 2
}

r=`test`

echo $?
```

![](/blog/linux-imgs/func2.png)

::: tips
- 函数的返回值需要在调用这个函数之后通过 `$?` 来获取
- **所有的函数必须在调用之前定义，否则会报错。**调用函数的时候直接使用函数名称(这时可以把函数名看作是一个命令)，**不需要加()**。
:::

`shell`中的函数和普通编程语言中的函数在定义时还是有一些区别的。比如，我们在js中定义一个函数

```js
function 函数名 (形参列表) {
  函数体
}

// 调用
函数名(实参列表)
```

在`shell`中，函数是没有`形参`的。获取实参需要通过`预设变量`来获取。比如，通过`$1`获取第一个参数,`$2`获取第二个参数，但是，如果我们需要获取第十个及以上的参数，需要通过`${参数索引}`的形式来获取。比如

```bash
function param() {
  echo "第一个参数是$1"
  echo "第二个参数是$2"
  echo "第十个参数是$10"
  echo "第十个参数是${10}"
}

# 传递参数
param 1 2 3 4 5 6 7 8 9 10
```

![](/blog/linux-imgs/func3.png)

`shell`中其实提供了很多的预设变量在函数中调用。

- **$#**：获取传递给函数的参数的个数

![](/blog/linux-imgs/func4.png)

- **$\***：用字符串的方式获取传递给函数的所有参数

![](/blog/linux-imgs/func5.png)

- **$$**：获取脚本运行的进程id

![](/blog/linux-imgs/func6.png)

- **$?**：获取函数的返回值，也是获取最后命令的退出状态。0表示没有错误，其他任何值表明有错误。

![](/blog/linux-imgs/func2.png)
