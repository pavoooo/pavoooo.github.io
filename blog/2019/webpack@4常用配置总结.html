<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack@4常用配置总结 | 赛赛的空间</title>
    <meta name="description" content="赵赛赛个人博客，关注前端技术，后端技术，喜欢编程。每天进步一点点就好啦！">
    <link rel="icon" type="image/x-icon" href="/blog/favicon.ico">
  <script type="text/javascript" src="/blog/bdtj.js"></script>
    
    <link rel="preload" href="/blog/assets/css/0.styles.626dd732.css" as="style"><link rel="preload" href="/blog/assets/js/app.7d2411b5.js" as="script"><link rel="preload" href="/blog/assets/js/46.3a521466.js" as="script"><link rel="prefetch" href="/blog/assets/js/42.81a8b80c.js"><link rel="prefetch" href="/blog/assets/js/2.285762ea.js"><link rel="prefetch" href="/blog/assets/js/3.baec0bba.js"><link rel="prefetch" href="/blog/assets/js/4.f2c636f9.js"><link rel="prefetch" href="/blog/assets/js/5.f22e182a.js"><link rel="prefetch" href="/blog/assets/js/6.705c6a76.js"><link rel="prefetch" href="/blog/assets/js/7.1b37c5d0.js"><link rel="prefetch" href="/blog/assets/js/8.2d387230.js"><link rel="prefetch" href="/blog/assets/js/9.8be4c074.js"><link rel="prefetch" href="/blog/assets/js/10.f945838f.js"><link rel="prefetch" href="/blog/assets/js/11.49fcc2bd.js"><link rel="prefetch" href="/blog/assets/js/12.d3602b67.js"><link rel="prefetch" href="/blog/assets/js/13.70b305bb.js"><link rel="prefetch" href="/blog/assets/js/14.32cf3f5c.js"><link rel="prefetch" href="/blog/assets/js/15.21ca5469.js"><link rel="prefetch" href="/blog/assets/js/16.80a1f156.js"><link rel="prefetch" href="/blog/assets/js/17.d510fcbf.js"><link rel="prefetch" href="/blog/assets/js/18.0addd3df.js"><link rel="prefetch" href="/blog/assets/js/19.af3cd491.js"><link rel="prefetch" href="/blog/assets/js/20.2b570a83.js"><link rel="prefetch" href="/blog/assets/js/21.5632325c.js"><link rel="prefetch" href="/blog/assets/js/22.41f8f69f.js"><link rel="prefetch" href="/blog/assets/js/23.0cbb2dd3.js"><link rel="prefetch" href="/blog/assets/js/24.20915592.js"><link rel="prefetch" href="/blog/assets/js/25.3f717d25.js"><link rel="prefetch" href="/blog/assets/js/26.da439741.js"><link rel="prefetch" href="/blog/assets/js/27.ed820e7d.js"><link rel="prefetch" href="/blog/assets/js/28.393e0886.js"><link rel="prefetch" href="/blog/assets/js/29.8f11c87b.js"><link rel="prefetch" href="/blog/assets/js/30.6fa1b714.js"><link rel="prefetch" href="/blog/assets/js/31.cbcfd68a.js"><link rel="prefetch" href="/blog/assets/js/32.6ca69442.js"><link rel="prefetch" href="/blog/assets/js/33.b622ba93.js"><link rel="prefetch" href="/blog/assets/js/34.e6754d06.js"><link rel="prefetch" href="/blog/assets/js/35.5ec069d4.js"><link rel="prefetch" href="/blog/assets/js/36.a05cc472.js"><link rel="prefetch" href="/blog/assets/js/37.fdfcc738.js"><link rel="prefetch" href="/blog/assets/js/38.c6be1692.js"><link rel="prefetch" href="/blog/assets/js/39.1606eea3.js"><link rel="prefetch" href="/blog/assets/js/40.eaa84eb1.js"><link rel="prefetch" href="/blog/assets/js/41.1713b648.js"><link rel="prefetch" href="/blog/assets/js/43.13bcacee.js"><link rel="prefetch" href="/blog/assets/js/44.fa99fe73.js"><link rel="prefetch" href="/blog/assets/js/45.76935316.js"><link rel="prefetch" href="/blog/assets/js/47.dd71926d.js"><link rel="prefetch" href="/blog/assets/js/48.946d3bf0.js"><link rel="prefetch" href="/blog/assets/js/49.d4766d95.js"><link rel="prefetch" href="/blog/assets/js/50.9e5efeac.js"><link rel="prefetch" href="/blog/assets/js/51.dd59f16d.js"><link rel="prefetch" href="/blog/assets/js/52.606ac267.js"><link rel="prefetch" href="/blog/assets/js/53.a9a14dfa.js"><link rel="prefetch" href="/blog/assets/js/54.7aed0af8.js"><link rel="prefetch" href="/blog/assets/js/55.4c24c889.js"><link rel="prefetch" href="/blog/assets/js/56.ddcdec7d.js"><link rel="prefetch" href="/blog/assets/js/57.9ed03f9e.js"><link rel="prefetch" href="/blog/assets/js/58.79007ed6.js"><link rel="prefetch" href="/blog/assets/js/59.864b375a.js"><link rel="prefetch" href="/blog/assets/js/60.f5fbcfb9.js"><link rel="prefetch" href="/blog/assets/js/61.9d17ca52.js"><link rel="prefetch" href="/blog/assets/js/62.0cfe3d87.js"><link rel="prefetch" href="/blog/assets/js/63.2b7b04f3.js"><link rel="prefetch" href="/blog/assets/js/64.4ef0a520.js"><link rel="prefetch" href="/blog/assets/js/65.9e8ec83f.js"><link rel="prefetch" href="/blog/assets/js/66.69f22d58.js"><link rel="prefetch" href="/blog/assets/js/67.0fd34747.js"><link rel="prefetch" href="/blog/assets/js/68.b60fb528.js"><link rel="prefetch" href="/blog/assets/js/69.8e65d31a.js"><link rel="prefetch" href="/blog/assets/js/70.fa373a57.js"><link rel="prefetch" href="/blog/assets/js/71.f35eb833.js"><link rel="prefetch" href="/blog/assets/js/72.3dd3e58d.js"><link rel="prefetch" href="/blog/assets/js/73.3e35a0cf.js"><link rel="prefetch" href="/blog/assets/js/74.87b9adaf.js"><link rel="prefetch" href="/blog/assets/js/75.408eed2c.js"><link rel="prefetch" href="/blog/assets/js/76.38acb539.js"><link rel="prefetch" href="/blog/assets/js/77.0bab9106.js"><link rel="prefetch" href="/blog/assets/js/78.1c8e954a.js"><link rel="prefetch" href="/blog/assets/js/79.117e4e0b.js"><link rel="prefetch" href="/blog/assets/js/80.18a9336b.js"><link rel="prefetch" href="/blog/assets/js/81.a31132f2.js"><link rel="prefetch" href="/blog/assets/js/82.7781f30f.js"><link rel="prefetch" href="/blog/assets/js/83.2ea08ef5.js"><link rel="prefetch" href="/blog/assets/js/84.eeb3575c.js"><link rel="prefetch" href="/blog/assets/js/85.b9d5a1cd.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.626dd732.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link"><img src="/blog/logo.png" alt="赛赛的空间" class="logo"> <span class="site-name can-hide">赛赛的空间</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">我的文章</a></div><div class="nav-item"><a href="/blog/good-writings.html" class="nav-link">阅读的好文</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">记录</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/translate.html" class="nav-link">翻译</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/zhaosaisai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">我的文章</a></div><div class="nav-item"><a href="/blog/good-writings.html" class="nav-link">阅读的好文</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">记录</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/translate.html" class="nav-link">翻译</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/zhaosaisai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h1>webpack@4常用配置总结</h1> <h2 id="webpack"><a href="#webpack" aria-hidden="true" class="header-anchor">#</a> webpack</h2> <p><code>webpack</code>是一个模块打包器。对于<code>webpack</code>而言，任何资源都会被看作是一个模块。它会从入口出发递归解析出每个文件的依赖，然后将这些依赖进行转换和打包，最终输出。</p> <h3 id="what-can-do"><a href="#what-can-do" aria-hidden="true" class="header-anchor">#</a> what can do</h3> <ul><li>代码转换</li> <li>文件优化</li> <li>代码分割</li> <li>模块合并</li> <li>自动刷新(热加载)</li> <li>代码校验</li> <li>自动发布</li></ul> <h3 id="安装"><a href="#安装" aria-hidden="true" class="header-anchor">#</a> 安装</h3> <p>本地安装<code>webpack</code>即可</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webpack@4 webpack-cli -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将<code>npm script</code>中添加<code>webpack</code>。</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>打包的时候直接运行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> run build

<span class="token comment"># 或者</span>
npx webpack
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>上述执行webpack命令的时候，如果你没有对webpack进行任何的配置，则会通过webpack默认配置对文件进行打包。</p></blockquote> <h2 id="webpack-config-js"><a href="#webpack-config-js" aria-hidden="true" class="header-anchor">#</a> webpack.config.js</h2> <p><code>webpack.config.js</code>是<code>webpack</code>默认的配置文件。下面是<code>webpack.config.js</code>的一些基本配置。</p> <ol><li><strong>mode</strong></li></ol> <p>用于指定<code>webpack</code>的运行环境。可以设置为<code>development</code>，<code>production</code>或者<code>none</code>。</p> <ul><li><strong>development</strong>：webpack运行环境是开发环境</li> <li><strong>production</strong>：webpack运行环境是生产环境</li> <li><strong>none</strong>：禁止webpack对环境的判断</li></ul> <ol start="2"><li><strong>entry</strong></li></ol> <p>指定项目入口。可以设置为<code>string</code>，<code>array</code>，<code>object</code>。</p> <ol start="3"><li><strong>output</strong></li></ol> <p>配置项目输出的相关特性。</p> <ul><li><strong>filename</strong>：设置打包后文件的名称</li> <li><strong>path</strong>：设置打包后文件的输出目录。必须是绝对路径</li></ul> <ol start="4"><li><strong>plugins</strong></li></ol> <p>配置所使用的插件</p> <ol start="5"><li><strong>module</strong></li></ol> <p>配置处理资源的<code>loader</code></p> <ol start="5"><li><strong>devtool</strong></li></ol> <p>配置<code>sourceMap</code></p> <ol start="6"><li><strong>externals</strong></li></ol> <p>定义全局引入的变量</p> <ol start="7"><li><strong>devServer</strong></li></ol> <p>定义开发服务器</p> <p>下面是一段简单的<code>webpack</code>配置文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span> <span class="token comment">// webpack运行环境。可以设置为development, production或者none</span>
  entry<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// 配置项目入口</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 配置项目输出相关的内容</span>
    filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span> <span class="token comment">// 打包后的文件名称</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 打包文件输出目录。必须是绝对路径</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="webpack-dev-server"><a href="#webpack-dev-server" aria-hidden="true" class="header-anchor">#</a> webpack-dev-server</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 配置webpack-dev-server</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    port<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token comment">// 服务端口号</span>
    progress<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 显示打包过程中的进度条</span>
    contentBase<span class="token punctuation">:</span> <span class="token string">'./build'</span><span class="token punctuation">,</span> <span class="token comment">// 指定服务根目录</span>
    open<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 服务启动后自动打开浏览器</span>
    compress<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启gzip压缩</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="处理html"><a href="#处理html" aria-hidden="true" class="header-anchor">#</a> 处理html</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> html-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后创建一个<code>html</code>模版</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 设置模版的地址</span>
      template<span class="token punctuation">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span>
      <span class="token comment">// 设置生成后的html文件的名称</span>
      filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
      <span class="token comment">// 对引入的静态文件添加一个hash</span>
      hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 设置标题</span>
      title<span class="token punctuation">:</span> <span class="token string">'标题'</span><span class="token punctuation">,</span>
      <span class="token comment">// 压缩html</span>
      minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 删除属性的双引号</span>
        removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 删除空行</span>
        collapseWhiteSpace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="处理样式"><a href="#处理样式" aria-hidden="true" class="header-anchor">#</a> 处理样式</h2> <p>处理样式需要使用对应的<code>loader</code>，<code>loader</code>的相关配置需要在<code>module</code>上下文中声明。处理样式一般会涉及到以下几个<code>loader</code></p> <ul><li><code>css-loader</code>：解析<code>@import</code>这种语法</li> <li><code>style-loader</code>：将生成的<code>css</code>插入到<code>head</code>标签中</li></ul> <blockquote><p>loader可以是字符串，也可以是数组(多个loader)，loader执行顺序是从右向左，从下往上执行。如果需要对loader传参，可以直接使用查询字符串或者以对象的形式使用loader，通过options选项传递参数</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> style-loader css-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用来配置各种loader规则</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 处理css文件，需要使用css-loader, style-loader</span>
      <span class="token punctuation">{</span> 
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token comment">// 可以传递loader需要的参数</span>
              <span class="token comment">// style标签插入的位置</span>
              insertAt<span class="token punctuation">:</span> <span class="token string">'top'</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token string">'css-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="处理less"><a href="#处理less" aria-hidden="true" class="header-anchor">#</a> 处理less</h3> <p>处理<code>less</code>依赖于<code>less-loader</code>。</p> <blockquote><p>处理sass, 依赖于sass-loader。如果需要处理css预处理文件，需要安装对应的loader。</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> less-loader <span class="token function">less</span> -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'less-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="抽离样式"><a href="#抽离样式" aria-hidden="true" class="header-anchor">#</a> 抽离样式</h3> <p>可以使用<code>mini-css-extract-plugin</code>将<code>loader</code>产生的<code>css</code>抽离到一个单独的文件中</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> mini-css-extract-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> 
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 在这里设置将css抽离到一个单独的文件中，可以替代style-loader</span>
          Mini<span class="token punctuation">.</span>CssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          Mini<span class="token punctuation">.</span>CssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'less-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 多次使用可以将对应负责的css抽离到多个文件中</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 抽离出的文件的名称</span>
      filename<span class="token punctuation">:</span> <span class="token string">'main.css'</span>
      <span class="token comment">// </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="使用postcss"><a href="#使用postcss" aria-hidden="true" class="header-anchor">#</a> 使用postcss</h3> <p><code>postcss</code>允许我们使用高级的<code>css</code>特性。它的作用类似于<code>javascript</code>界中的<code>babel</code>。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> postcss-loader autoprefixer -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在根目录下创建一个<code>postcss.config.js</code>文件，用来配置我们的<code>postcss</code>。当然，你可以通过<code>loader</code>的参数的形式将配置传入。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// postcss.config.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
      <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
      <span class="token comment">// 在css-loader之前用postcss进行处理</span>
      <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
      <span class="token string">'less-loader'</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="压缩css"><a href="#压缩css" aria-hidden="true" class="header-anchor">#</a> 压缩css</h3> <p>压缩<code>css</code>依赖于<code>optimize-css-asserts-webpack-plugin</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> optimize-css-asserts-webpack-plugin uglifyjs-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> OptimizeCssAssertsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-asserts-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> UglifyjsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'uglifyjs-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在这里设置具体的优化点</span>
  <span class="token comment">// 比如压缩css，js等</span>
  <span class="token comment">// 如果只声明了css压缩配置，js就不能被压缩了。</span>
  <span class="token comment">// 所以，如果需要同时压缩css，js则两个优化点都需要写上</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssertsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">UglifyjsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 是否使用缓存</span>
        cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 开启并行压缩</span>
        parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 开启sourceMap</span>
        sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 多次使用可以将对应负责的css抽离到多个文件中</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 抽离出的文件的名称</span>
      filename<span class="token punctuation">:</span> <span class="token string">'main.css'</span>
      <span class="token comment">// </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="处理javascript"><a href="#处理javascript" aria-hidden="true" class="header-anchor">#</a> 处理javascript</h2> <p>处理<code>javascript</code>我们一般会使用<code>babel</code>，结合<code>webpack</code>，我们会使用<code>babel-loader</code>来处理<code>javascript</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install babel<span class="token operator">-</span>loader @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>babel@7对babel的各个核心组件都挂载到了<code>@babel</code>域下</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
          <span class="token comment">// babel编译选项建议写在babel.config.js中</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token string">'@babel/preset-env'</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token template-string"><span class="token string">``</span></span>

创建一个<span class="token template-string"><span class="token string">`babel.config.js`</span></span>文件来替代<span class="token template-string"><span class="token string">`babel-loader`</span></span>的<span class="token template-string"><span class="token string">`options`</span></span>选项

<span class="token template-string"><span class="token string">``</span></span>`js
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/preset-env'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/plugin-proposal-class-properties'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="全局变量引入问题"><a href="#全局变量引入问题" aria-hidden="true" class="header-anchor">#</a> 全局变量引入问题</h2> <p><code>webpack</code>在打包我们的模块的时候，会将我们模块封装在一个闭包中。这样，对于我们在模块中引入的第三方包，我们是无法直接通过<code>window</code>来获取的，只能在当前模块中使用。</p> <p>比如，安装一下<code>jquery</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> jquery
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们的模块文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">'jquery'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span> <span class="token comment">// Jquery函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>$<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果你希望模块中的某个变量暴露给<code>window</code>，比如这个模块中的<code>$</code>，可以通过下面几种方式来处理</p> <h3 id="expose-loader"><a href="#expose-loader" aria-hidden="true" class="header-anchor">#</a> expose-loader</h3> <p>这个<code>loader</code>就是用来暴露全局的<code>loader</code>。这个<code>loader</code>可以使用<code>内联loader</code>的方式配置，即我们可以直接在项目代码中使用。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> expose-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后在我们的模块文件中使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">'expose-loader?$!jquery'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span> <span class="token comment">// Jquery函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>$<span class="token punctuation">)</span> <span class="token comment">// Jquery函数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当然，也可以在配置文件中直接配置，这个时候，我们就不能使用文件后缀进行匹配了，而是直接使用文件路径进行匹配。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'expose-loader?$'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="全局变量注入模块"><a href="#全局变量注入模块" aria-hidden="true" class="header-anchor">#</a> 全局变量注入模块</h3> <p>我们可以使用<code>webpack</code>自带的插件<code>webpack.ProvidePlugin</code>将第三方包暴露出的变量直接注入到每个模块中，这样就不需要在每个模块中引入对应的模块了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 变量名称: 模块名称</span>
      $<span class="token punctuation">:</span> <span class="token string">'jquery'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="externals"><a href="#externals" aria-hidden="true" class="header-anchor">#</a> externals</h3> <p>在某些情况下我们使用<code>script</code>标签引入了某些第三方的包，在我们的模块中也使用<code>import</code>对这个第三方的包进行了引入。<code>webpack</code>在默认情况下会对我们引入的模块进行打包，即使我们已经全局引入了。这时，我们就可以通过<code>externals</code>来告诉<code>webpack</code>我们已经在全局中引入了对应的变量，模块中引入的这个模块就不用打包了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  externals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    jquery<span class="token punctuation">:</span> <span class="token string">'$'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="处理图片"><a href="#处理图片" aria-hidden="true" class="header-anchor">#</a> 处理图片</h2> <p>项目中引入图片大概有以下几种</p> <ul><li><code>html</code>中通过<code>img</code>标签引入</li> <li><code>css</code>通过<code>background-img</code>等属性引入</li> <li><code>javascript</code>中通过脚本动态创建图片</li></ul> <p>上面几种使用图片的方式，<code>webpack</code>是都能处理的。</p> <p><code>webpack</code>处理图片的<code>loader</code>是<code>file-loader</code>。它的作用就是在内部生成一张图片到构建目录下，然后将生成的图片的地址返回。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 会被file-loader处理</span>
<span class="token keyword">import</span> logo <span class="token keyword">from</span> <span class="token string">'./logo.png'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span> <span class="token comment">// 是一段字符串</span>

<span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
image<span class="token punctuation">.</span>src <span class="token operator">=</span> logo

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>在javascript中使用图片需要使用模块化的语法。css中引入的图片<code>css-loader</code>会对其转换成模块化的引入。如果想操作html中的标签引入的图片，可以使用<code>html-withimg-loader</code>。</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> html-withimg-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.html?$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'html-withimg-loader'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>虽然<code>file-loader</code>能够为我们处理图片，但其所做的事情也是挺简单的。有的时候我们需要直接将小图片转为<code>base64</code>格式，减少<code>http</code> 的请求。这种情况下，我们可以使用<code>url-loader</code>。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> url-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpg|gif)/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment">//  图片小于200k的情况下将图片转为base64</span>
            <span class="token comment">// 否则使用file-loader进行处理</span>
            limit<span class="token punctuation">:</span> <span class="token number">200</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
            <span class="token comment">// 我们也可以将打包的图片统一放在指定的目录下</span>
            outputPath<span class="token punctuation">:</span> <span class="token string">'img/'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="静态资源分类"><a href="#静态资源分类" aria-hidden="true" class="header-anchor">#</a> 静态资源分类</h2> <p><code>静态资源分类</code>一般是指将编译后的静态文件分目录进行存放，比如将图片统一放在<code>img</code>目录下，将<code>css</code>统一放在<code>css</code>目录下。</p> <h3 id="图片分类"><a href="#图片分类" aria-hidden="true" class="header-anchor">#</a> 图片分类</h3> <p>只需要在<code>url-loader</code>中指定<code>outputPath</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpg|gif)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          <span class="token comment">// 设置放置的路径即可</span>
          outputPath<span class="token punctuation">:</span> <span class="token string">'img/'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="css分类"><a href="#css分类" aria-hidden="true" class="header-anchor">#</a> css分类</h3> <p>只需要在<code>MiniCssExtractPlugin</code>中设置<code>filename</code>的时候使用<code>/</code>即可</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 抽离出的文件的名称</span>
    filename<span class="token punctuation">:</span> <span class="token string">'css/main.css'</span>
    <span class="token comment">// </span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="publicpath"><a href="#publicpath" aria-hidden="true" class="header-anchor">#</a> publicPath</h3> <p>如果线上的静态文件放置在<code>cdn</code>上，需要将<code>output.publicPath</code>设置成对应的<code>cdn</code>地址即可</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token punctuation">:</span> <span class="token string">'cdn地址'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面所有路径的<code>resolve</code>工具会自动帮我们完成。但是如果我们在<code>output</code>中设置了<code>publicPath</code>则所有的静态资源都会以这个<code>cdn</code>地址进行请求。如果我们只想将图片放在这个<code>cdn</code>上，则可以只指定图片的<code>publicPath</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpg|gif)$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        <span class="token comment">// 设置放置的路径即可</span>
        outputPath<span class="token punctuation">:</span> <span class="token string">'img/'</span><span class="token punctuation">,</span>
        <span class="token comment">// 图片的cdn地址</span>
        publicPath<span class="token punctuation">:</span> <span class="token string">'cdn地址'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="多页应用"><a href="#多页应用" aria-hidden="true" class="header-anchor">#</a> 多页应用</h2> <p><code>多页应用</code>的关键就是在指定入口的时候以对象的形式指定多个入口(打包入口)。设置输出的时候，注意文件名的设置，一般都使用<code>[name]``[hash]</code>等来指定文件的输出。还需要注意的是要生成多个<code>html</code>文件作为访问入口。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 多入口配置</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    home<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    other<span class="token punctuation">:</span> <span class="token string">'./src/other.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 生成各个js文件</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'build'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 需要多次调用HtmlWebpackPlugin来生成页面</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'home'</span><span class="token punctuation">,</span> <span class="token string">'other'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>name <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token punctuation">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span>
      filename<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>home<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html`</span></span><span class="token punctuation">,</span>
      <span class="token comment">// 指定html中需要引入的代码块名称</span>
      <span class="token comment">// 不设置的话每个生成的html文件都会把打包生成的所有js都引入进去</span>
      <span class="token comment">// chunks是一个数组，可以指定多个chunk的名称</span>
      chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="sourcemap"><a href="#sourcemap" aria-hidden="true" class="header-anchor">#</a> sourceMap</h2> <p><code>sourceMap</code>可以让我们在调试的时候直接定位到源文件中具体的位置，开启<code>sourceMap</code>的功能是<code>webpack</code>自带的，我们可以直接通过配置来指定。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 开启sourceMap功能的属性</span>
  devtool<span class="token punctuation">:</span> <span class="token string">'source-map'</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token string">'@babel/presets-env'</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><code>webpack</code>通过配置文件中<code>devtool</code>来配置<code>sourceMap</code>。</p> <ul><li><strong>source-map</strong>：单独生成一个<code>sourceMap</code>文件，特点是大而全</li> <li><strong>eval-source-map</strong>：不会生成一个单独的文件，而是将<code>sourceMap</code>的内容嵌入到项目代码中</li> <li><strong>cheap-module-source-map</strong>：不会包含列信息，但是会产生一个单独的文件，并不会和我们的代码关联。</li> <li><strong>cheap-module-eval-source-map</strong>：不会产生文件，集成在打包后的文件中，也不会产生列信息</li></ul> <h2 id="watch"><a href="#watch" aria-hidden="true" class="header-anchor">#</a> watch</h2> <p><code>webpack</code>启动的时候可以指定<code>watch</code>参数，在代码变化的时候自动编译打包</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>webpack --watch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当然，你也可以在<code>webpack.config.js</code>中进行配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  watch<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>也可以指定<code>watch</code>的参数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  watch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  watchOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 轮询时间</span>
    poll<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token comment">// 防抖，下面的参数就表示如果在文件变化后，500ms内没有新的变化，就进行打包</span>
    aggreateTimeout<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    <span class="token comment">// 指定忽略的文件</span>
    ignored<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="常用小插件"><a href="#常用小插件" aria-hidden="true" class="header-anchor">#</a> 常用小插件</h2> <h3 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" aria-hidden="true" class="header-anchor">#</a> clean-webpack-plugin</h3> <p>这个插件主要是用来在打包文件前将之前的输出目录进行删除</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> clean-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 可以传入一个字符串或者一个数组，表示需要进行删除的目录</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="copy-webpack-plugin"><a href="#copy-webpack-plugin" aria-hidden="true" class="header-anchor">#</a> copy-webpack-plugin</h3> <p>这个插件用来将某个目录或者文件拷贝到特定的目录下</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> copy-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token comment">// from 表示源目录</span>
      <span class="token comment">// to 表示拷贝到的目录</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'./docs'</span><span class="token punctuation">,</span>
        to<span class="token punctuation">:</span> <span class="token string">'./'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="bannerplugin"><a href="#bannerplugin" aria-hidden="true" class="header-anchor">#</a> bannerPlugin</h3> <p>这是<code>webpack</code>内置的插件，可以用来在输出文件的头和尾的地方添加内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> BannerPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">BannerPlugin</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Created at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="defineplugin"><a href="#defineplugin" aria-hidden="true" class="header-anchor">#</a> definePlugin</h3> <p>这是<code>webpack</code>内置插件，可以用来定义文件中的一些变量的值</p> <p>比如，我们在前端项目中使用<code>process.env.NODE_ENV</code>来判断运行环境。前端是没有<code>process.env.NODE_ENV</code>变量的，我们就可以通过这个插件获取当前运行环境的环境变量，然后替代掉我们项目中的<code>process.env.NODE_ENV</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开发环境'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'生产环境'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'process.env'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'NODE_ENV'</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span> <span class="token comment">// 这里的process.env.NODE_ENV是通过nodejs获取当前运行环境</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果我们设置的环境变量<code>NODE_ENV</code>的值是<code>development</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">export</span> NODE_ENV<span class="token operator">=</span><span class="token string">'development'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>则我们的项目中的代码就是</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'development'</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开发环境'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'生产环境'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>生产环境也是此方式替代。</p> <h2 id="webpack处理跨域"><a href="#webpack处理跨域" aria-hidden="true" class="header-anchor">#</a> webpack处理跨域</h2> <p><code>webpack</code>可以在配置文件中指定需要代理的接口，可以解决开发环境下接口跨域的问题。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 用来配置代理服务器的，其实就是配置webpack-dev-server</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用来配置需要代理的接口，详情可看http-proxy-middleware模块</span>
    proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 所有以api开头的请求，通过代理服务器，将请求转发到localhost:3000服务上</span>
      <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">'http://localhost/3000'</span><span class="token punctuation">,</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>上面的配置是通过代理请求后端的服务，这种场景一般用在产品联调的阶段。在开发阶段，后端的接口可能还在开发中，这时候，前端就需要依靠自己的能力来mock数据。同样，我们也可以直接使用<code>webpack</code>，因为<code>webpack-dev-server</code>在启动的时候就已经启动了一个<code>express</code>服务，我们可以直接利用这个服务来<code>mock</code>接口和数据。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 启动的钩子，启动前会调用，接收的参数就是内部创建的express实例</span>
    <span class="token function">before</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 使用app的任何属性和方法来创建服务</span>
      app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'saisai'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这种方式前后端启动在同一个域名和端口下，所以也就不存在跨域的问题了。</p> <p>当然，你也可以自己编写<code>node</code>脚本来同时启动前端和后端服务</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> middle <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middle'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> compile <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>

<span class="token comment">// 启动webpack</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">middle</span><span class="token punctuation">(</span>compile<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 后端服务接口</span>
app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'saisai'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这种情况下也是同时启动前后端的一种方式，所以也是不会存在跨域的问题。这种场景一般出现在后端是<code>node</code>服务，那么我们就可以通过这种方式，将开发阶段的前后端启动在同一个服务下面。</p> <h2 id="resolve"><a href="#resolve" aria-hidden="true" class="header-anchor">#</a> resolve</h2> <p><code>resolve</code>主要用来设置解析模块时候的一些相关功能。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这个属性主要用来设置第三方模块的查找路径</span>
    <span class="token comment">// 默认的就是commonjs的规则，从当前目录的node_modules出发，一级一级的向上查找</span>
    <span class="token comment">// 我们可以在这里显示设置这个查找规则</span>
    modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 这个规则就告诉webpack只需要在当前目录下的node_modules查找即可</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'node_modules'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 这个属性主要用来设置第三方包的别名</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 下面这个属性表示，当引入vue的时候，实际上引入vue包中的vue/dist/vue.esm.js</span>
      <span class="token comment">// import 'vue' --&gt; import 'vue/dist/vue.esm.js'</span>
      <span class="token string">'vue$'</span><span class="token punctuation">:</span> <span class="token string">'vue/dist/vue.esm.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 这个规则和package.json中main字段的作用类似</span>
    mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'main'</span><span class="token punctuation">,</span> <span class="token string">'next'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 这个规则用来设置匹配文件时候的后缀</span>
    <span class="token comment">// 匹配顺序就是 .js -&gt; .ts -&gt; .jsx</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="懒加载"><a href="#懒加载" aria-hidden="true" class="header-anchor">#</a> 懒加载</h2> <p><code>懒加载</code>让我们只有在用到某个模块的时候才会去真正的加载它。懒加载主要是用<code>import()</code>函数，使用这个函数需要使用<code>@babel/plugin-syntax-dynamic-import</code>插件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/plugin-syntax-dynamic-import'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span>文件路径<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="hot-reload"><a href="#hot-reload" aria-hidden="true" class="header-anchor">#</a> hot reload</h2> <p><code>webpack-dev-server</code>给我们提供了热加载的功能，可以让我们在不刷新页面的情况下，网页中显示出变化的内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 需要把这个选项设置为true</span>
    hot<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 开启热更新插件</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 告诉我们哪个模块更新了</span>
    <span class="token comment">// 打印出更新的模块路径</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>NamedModulesPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>上面只是<code>webpack</code>关于热更新的相关配置，下面我们还需要在项目代码中开启热加载的功能。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="webpack中的优化"><a href="#webpack中的优化" aria-hidden="true" class="header-anchor">#</a> webpack中的优化</h2> <h3 id="noparse"><a href="#noparse" aria-hidden="true" class="header-anchor">#</a> noParse</h3> <p>这个规则是用来告诉<code>webpack</code>，不需要对哪些模块进行依赖检测，直接打包即可。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这个配置就是告诉webpack不要去解析jquery中的依赖</span>
  noParse<span class="token punctuation">:</span> <span class="token regex">/jquery/</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="ignoreplugin"><a href="#ignoreplugin" aria-hidden="true" class="header-anchor">#</a> IgnorePlugin</h3> <p>这个插件允许<code>webpack</code>在打包的时候忽略某些内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span>
  requestRegExp<span class="token punctuation">,</span> <span class="token comment">// 路径正则表达式</span>
  contextRegExp <span class="token comment">// 资源上下文(正则表达式)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>比如，我们可以在引入<code>moment</code>的时候，使用 IgnorePlugin 在打包时忽略本地化内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex">/^\.\/locale$/</span><span class="token punctuation">,</span> <span class="token regex">/moment$/</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="dllplugin"><a href="#dllplugin" aria-hidden="true" class="header-anchor">#</a> DllPlugin</h3> <p><code>DllPlugin</code>和<code>DllReferencePlugin</code>插件可以结合在一起使用，对产出的bundle文件进行拆包，加快<code>webpack</code>的打包速度，提升构建性能。</p> <p>一般的做法就是将不需要经常改变的包，比如第三方库等使用<code>DllPlugin</code>单独打包。然后在进行项目代码打包的时候使用<code>DllReferencePlugin</code>将打包后的第三方包引入进来。</p> <p><code>DllPlugin</code>就是用来打包出一个个单独的动态链接库文件。<code>DllReferencePlugin</code>用来在主要的配置文件中引入<code>DllPlugin</code>插件打包好的动态链接库文件。</p> <p>所以，一般我们会创建两个配置文件，一个用于打包动态链接库的配置<code>webpack.dll.config.js</code>，另一个就是用来打包项目代码的<code>webpack.config.js</code>。</p> <p>所以，我们可以对<code>webpack.dll.config.js</code>进行如下配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 指定需要打包到动态链接库中的模块</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    react<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'react-dom'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    axios<span class="token punctuation">:</span> <span class="token string">'axios'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 输出的动态链接库的名称</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// 这一步很关键，这里就是用来设置存放动态链接库的 全局变量的名称 </span>
    <span class="token comment">// 对于上面entry指定的react来说 打包后的全局变量的名称就是 _dll_react</span>

    <span class="token comment">// 这里也就默认了 libraryTarget 是 var</span>
    library<span class="token punctuation">:</span> <span class="token string">'_dll_[name]'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 然后就是接入动态链接库插件</span>
    <span class="token keyword">new</span> <span class="token class-name">DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 指定动态链接库中全局变量的名称</span>
      <span class="token comment">// 一定要和output.library 中指定的值相同</span>
      <span class="token comment">// 这个字段也是输出的manifest.json中name字段的值</span>
      name<span class="token punctuation">:</span> <span class="token string">'_dll_[name]'</span><span class="token punctuation">,</span>
      <span class="token comment">// 指定动态链接库manifest.json文件输出时候的文件的名称</span>
      path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'[name].manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>上面就是对输出动态链接库的一个大概配置，运行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>webpack --config webpack.dll.config.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就会生成动态链接库文件和一份动态链接库描述文件</p> <p>下面我们就需要对我们的项目配置文件<code>webpack.config.js</code>进行配置，引入上面生成的动态链接库，这里就主要依靠<code>DllReferencePlugin</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 有多个需要引入多次</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 上面生成的manifest.json文件</span>
      manifest<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'react.manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 上面生成的manifest.json文件</span>
      manifest<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'axios.manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>关于<code>DllPlugin</code>插件使用的一些注意事项</p> <p><code>DllPlugin</code>插件中的<code>name</code>属性的值必须和<code>output.library</code>中的值一致，因为<code>DllPlugin</code>插件中的<code>name</code>会影响输出的<code>manifest.json</code>文件中的<code>name</code>字段的值，而在进行项目打包的时候<code>DllReferencePlugin</code>会使用这个字段查找同名的全局变量来使用。</p> <h3 id="happypack"><a href="#happypack" aria-hidden="true" class="header-anchor">#</a> happypack</h3> <p><code>webpack</code>的打包操作需要对大量的文件进行解析和处理，当文件的数量变得很多后，<code>webpack</code>的构建是十分缓慢的。因为<code>Nodejs</code>是单线程的执行，所以不管有多少文件和任务，<code>webpack</code>也只能一个个的去处理。<code>happypack</code>能够让<code>webpack</code>同一时刻处理多个任务，发挥了多核<code>CPU</code>的作用。它会把多个任务拆分成一个个的子任务并分解给多个子进程去执行，子进程处理完后，再将结果发送给主进程。</p> <p><code>happypack</code>的核心主要是<code>任务分解</code>和<code>进程管理</code>。这两部分工作其内部已经处理，所以我们在使用的时候只需要接入<code>happypack</code>即可。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> happypack -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'happypack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.jsx?$/</span><span class="token punctuation">,</span>
        <span class="token comment">// 使用happypack内部的loader</span>
        <span class="token comment">// id参数就是在插件中定义的</span>
        use<span class="token punctuation">:</span> <span class="token string">'happypack/loader?id=js'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 使用loader的时候指定的参数</span>
      id<span class="token punctuation">:</span> <span class="token string">'js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="tree-shaking"><a href="#tree-shaking" aria-hidden="true" class="header-anchor">#</a> tree-shaking</h3> <p><code>tree-shaking</code>可以用来剔除<code>javascript</code>中没有用到的代码。它依赖于<code>es6</code>的模块化语法，即通过<code>import</code>和<code>export</code>导入和导出。</p> <p><code>tree-shaking</code>的使用有两个前提</p> <ul><li>javascript代码必须使用<code>es6</code>的模块化语法，因为<code>es6</code>的模块化语法是静态的，可以让<code>webpack</code>分析出哪些export被import了。</li> <li>关闭<code>@babel/presets-env</code>的模块转换功能</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">'@babel/presets-env'</span><span class="token punctuation">,</span> 
      <span class="token punctuation">{</span>
        module<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>配置了上述文件中，比如我们的<code>a.js</code>代码如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">-</span> b
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>我们的<code>index.js</code>的代码如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> sum <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./a'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们只在<code>index.js</code>文件中使用了<code>sum</code>函数，在生产模式下进行编译的时候<code>webpack</code>会自动的为我们剔除<code>minus</code>相关的代码。</p> <h3 id="scope-hosting"><a href="#scope-hosting" aria-hidden="true" class="header-anchor">#</a> scope hosting</h3> <p><code>scope hosting</code>被称为作用域提升，它能让我们打包后的代码体积更小。它的原理就是分析模块之间的关系，尽可能的将被打散的模块合并到一个函数中。<code>scope hosting</code>会分析模块之间的依赖关系，因此源码也必须采用<code>es6</code>的模块化语句。</p> <p>比如</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>打包后的代码为</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p><code>tree shaking</code>和<code>scope hosting</code>在<code>webpack@4</code>中自动集成了，不需要我们做其它额外的配置。</p></blockquote> <h2 id="抽离公共代码"><a href="#抽离公共代码" aria-hidden="true" class="header-anchor">#</a> 抽离公共代码</h2> <p>抽离公共代码可以把多个模块引入的相同模块抽离出来进行打包，也可以减少打包后的文件的体积。抽离公共代码的功能一般在多页应用使用。抽离公共代码的配置同样是在<code>optimization</code>中配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分割代码块</span>
    splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 缓存组</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 抽离项目中的模块</span>
        <span class="token comment">// 将公共代码抽离到一个文件中</span>
        common<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 公用的代码的体积</span>
          miniSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token comment">// 公共代码被引用了多少次</span>
          <span class="token comment">// 一般配置&gt;=2</span>
          miniChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token comment">// 从哪里开始提取代码</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'initial'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 抽离第三方模块</span>
        vendor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          test<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
          miniSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          miniChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'initial'</span><span class="token punctuation">,</span>
          <span class="token comment">// 设置优先级，这样就能保证先抽离第三方模块然后再抽离业务中的公共模块</span>
          priority<span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/blog/assets/js/46.3a521466.js" defer></script><script src="/blog/assets/js/app.7d2411b5.js" defer></script>
  </body>
</html>
